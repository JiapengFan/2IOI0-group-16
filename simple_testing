import pandas as pd
import numpy as np


def MSEcalc(data, actualtime_col :str, prediction_col :str):
    total_mse = 0
    
    for i in range(len(data)):
        mse = ((data[prediction_col][i] - data[actualtime_col][i])^2)
        total_mse += mse
    
    return total_mse
    
def accuracy_intervals(data, actualtime_col :str, prediction_col :str, error_margin):
    correct = 0
    one_stage_off = 0
    two_plus_stages_off = 0
    
    for i in range(len(data)):
        error = (data[prediction_col][i] - data[actualtime_col][i])
        if error < 0:
            error = error * -1
            
        if error < error_margin :
            correct += 1
            
        elif error > error_margin and error < 2*error_margin:
            one_stage_off += 1
            
        elif error > 2*error_margin:
            two_plus_stages_off += 1
            
     return '{} predictions are within one error margin, {} between one and two margins off, {} are more than two error margins off'.format(correct, one_stage_off, two_plus_stages_off)
    
def event_accuracy(data, actualtime_event :str, prediction_event :str):
    acc = 0
    for i in range(len(data)):
        if data[actual_event][i] == data[predicted_event][i]:
            acc += 1
    
    accuracy = acc/len(data) 
    return accuracy
